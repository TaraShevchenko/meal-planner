# ТЕХНИЧЕСКИЕ СПЕЦИФИКАЦИИ MEAL PLANNER

## ФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

### 1. Планнер-дневник питания

#### Основные возможности:

- Планирование приемов пищи на день/неделю/месяц
- Отметка выполненных приемов пищи
- Просмотр истории питания
- Копирование планов между днями

#### Технические детали:

- Календарный интерфейс для навигации
- Drag & drop для перемещения блюд
- Автосохранение изменений
- Синхронизация между устройствами

### 2. Учет пищевой ценности

#### Отслеживаемые параметры:

- Калории (ккал)
- Белки (г)
- Жиры (г)
- Углеводы (г)
- Клетчатка (г)
- Сахар (г)
- Натрий (мг)

#### Будущие параметры:

- Витамины (A, B, C, D, E, K)
- Минералы (железо, кальций, магний)
- Омега-3 и Омега-6
- Антиоксиданты

#### Визуализация:

- Круговые диаграммы БЖУ
- Прогресс-бары для целевых значений
- Цветовая индикация превышения норм
- Графики динамики по дням/неделям

### 3. Система блюд и рецептов

#### Рецепты (Recipe):

```typescript
interface Recipe {
  id: string;
  name: string;
  description?: string;
  cookingTime: number; // минуты
  servings: number; // количество порций
  difficulty: "easy" | "medium" | "hard";
  category: string;
  tags: string[];
  instructions: string[];
  ingredients: RecipeIngredient[];
  nutrition: NutritionInfo;
  photos: string[];
  createdBy: string;
  isPublic: boolean;
}

interface RecipeIngredient {
  ingredientId: string;
  amount: number; // в граммах
  unit: "g" | "serving" | "piece";
  notes?: string;
}
```

#### Быстрые блюда (QuickMeal):

```typescript
interface QuickMeal {
  id: string;
  name: string;
  restaurant?: string;
  estimatedNutrition: NutritionInfo;
  photos?: string[];
  notes?: string;
  price?: number;
  location?: string;
}
```

### 4. Гибкие единицы измерения

#### Поддерживаемые единицы:

- **Вес:** граммы, килограммы
- **Объем:** миллилитры, литры
- **Штучные:** штуки, порции
- **Кулинарные:** чашки, столовые ложки, чайные ложки

#### Система конвертации:

```typescript
interface UnitConversion {
  ingredientId: string
  fromUnit: string
  toUnit: string
  ratio: number // коэффициент пересчета
}

// Пример: 1 чашка муки = 120г
{
  ingredientId: 'flour-wheat',
  fromUnit: 'cup',
  toUnit: 'g',
  ratio: 120
}
```

### 5. История порций

#### Функционал:

- Сохранение 3 самых популярных размеров порций
- Быстрый доступ к часто используемым количествам
- Автоматическое обновление популярности
- Возможность закрепления избранных размеров

#### Структура данных:

```typescript
interface PortionHistory {
  userId: string;
  itemId: string; // recipe или ingredient ID
  itemType: "recipe" | "ingredient" | "quickMeal";
  portions: PortionEntry[];
}

interface PortionEntry {
  amount: number;
  unit: string;
  usageCount: number;
  lastUsed: Date;
  isPinned: boolean;
}
```

### 6. Семейный режим

#### Возможности:

- Создание семейных групп
- Приглашение участников
- Общее планирование питания
- Индивидуальные цели по БЖУ
- Распределение порций между участниками

#### Роли в семье:

- **Администратор:** полный доступ к управлению
- **Планировщик:** может создавать и редактировать планы
- **Участник:** может просматривать и отмечать выполнение

### 7. Система покупок

#### Автоматическое формирование списка:

- Выбор диапазона дат для планирования
- Выбор участников семьи
- Суммирование ингредиентов из всех блюд
- Группировка по категориям продуктов

#### Умная фасовка:

```typescript
interface ProductPackaging {
  ingredientId: string;
  store: string;
  packageSizes: number[]; // доступные фасовки в граммах
  prices: number[]; // цены соответствующих фасовок
  minPurchaseAmount: number; // минимальная покупаемая фасовка
}
```

#### Категории в списке покупок:

1. **Обязательные покупки** - количество превышает минимальную фасовку
2. **Проверить наличие** - количество меньше минимальной фасовки

### 8. Детальный режим дня

#### Информация для каждого блюда:

- Время приготовления
- Необходимые ингредиенты с точными граммовками
- Пошаговые инструкции
- Количество получаемых порций
- Способ разделения на порции
- Время подачи

## НЕФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

### Производительность

- Загрузка страницы < 2 секунд
- Отклик на действия пользователя < 500мс
- Поддержка до 1000 рецептов на пользователя
- Поддержка семей до 10 участников

### Масштабируемость

- Горизонтальное масштабирование через Vercel
- Оптимизация запросов к БД через Prisma
- Кэширование статических данных
- CDN для изображений

### Безопасность

- HTTPS для всех соединений
- Валидация всех входных данных
- Rate limiting для API
- Защита от XSS и CSRF

### Доступность

- WCAG 2.1 AA соответствие
- Поддержка скрин-ридеров
- Клавиатурная навигация
- Контрастность цветов

### Совместимость

- Современные браузеры (Chrome 90+, Firefox 88+, Safari 14+)
- Мобильные устройства (iOS 14+, Android 10+)
- Планшеты и десктопы
- Прогрессивное улучшение

## ИНТЕГРАЦИИ

### Текущие

- **Clerk** - аутентификация и управление пользователями
- **Supabase** - хостинг базы данных PostgreSQL
- **Vercel** - хостинг приложения

### Планируемые

- **OpenAI Vision API** - распознавание блюд по фото
- **Nutritionix API** - база данных продуктов
- **Google Maps API** - геолокация ресторанов
- **Stripe** - платежи (для премиум функций)

## МОНИТОРИНГ И АНАЛИТИКА

### Метрики производительности

- Core Web Vitals
- Время загрузки страниц
- Частота ошибок API
- Использование памяти

### Пользовательская аналитика

- Активность пользователей
- Популярные функции
- Конверсия регистрации
- Retention rate

### Инструменты

- Vercel Analytics
- Sentry для отслеживания ошибок
- PostHog для пользовательской аналитики
